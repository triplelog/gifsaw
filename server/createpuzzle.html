<!DOCTYPE html>

	
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gifsaw</title>
<meta name="description" content="."/>

<style>

</style>

</head>
<body>

<label for="npieces">Number of Pieces</label>
<input type="number" id="npieces" name="npieces"></input>

<label for="size">Size</label>
<select id="size">
</select>

<label for="nrows">Number of Rows</label>
<input type="number" id="nrows" name="nrows"></input>

<label for="ncols">Number of Columns</label>
<input type="number" id="ncols" name="ncols"></input>

<script>
function updateNpieces() {
	var npieces = document.getElementById('npieces').value;
	var height = imageHeight || 1000;
	var width = imageWidth || 1000;
	var dimensions = [];
	if (npieces <0){
		return;
	}
	
	let nrowsf = Math.floor(Math.sqrt(npieces*height/width));
	let ncolsf = Math.floor(nrowsf*width/height);

	
	//Find closest approximations
	var mind = npieces*2;
	if (nrowsf <3){nrowsf = 3;}
	if (ncolsf <3){ncolsf = 3;}
	for (var i=nrowsf-2;i<nrowsf+4;i++) {
		for (var ii=ncolsf-2;ii<ncolsf+4;ii++) {
			var nnpieces = i*ii;
			var npieceserr = Math.sqrt( (nnpieces-npieces)*(nnpieces-npieces)/(npieces*npieces) );
			var rat = ii/i;
			var raterr = Math.sqrt( (rat-width/height)*(rat-width/height)/((width/height)*(width/height)) );
			var score = (raterr+.01) * Math.pow( npieceserr+.01, 2);
			var dim = {nrows:i,ncols:ii,score:score};
			dimensions.push(dim);
		}
	}
	
	//Find nearest factors
	for (var i=1;i<npieces+1;i++) {
		if (npieces % i == 0){
			ii = npieces/i;
			var nnpieces = i*ii;
			var npieceserr = Math.sqrt( (nnpieces-npieces)*(nnpieces-npieces)/(npieces*npieces) );
			var rat = ii/i;
			var raterr = Math.sqrt( (rat-width/height)*(rat-width/height)/((width/height)*(width/height)) );
			var score = (raterr+.01) * Math.pow( npieceserr+.01, 2);
			var dim = {nrows:i,ncols:ii,score:score};
			var isRepeat = false;
			for (var i in dimensions){
				if (dimensions[i].nrows==i && dimensions[i].ncols==ii){
					isRepeat = true;
				}
			}
			if (!isRepeat){
				dimensions.push(dim);
			}
			
		}
	}
	dimensions.sort(function compare(a, b) {
	  if (a.score > b.score) return 1;
	  if (b.score > a.score) return -1;

	  return 0;
	});
	console.log(dimensions);
	
}
document.getElementById('npieces').addEventListener('change',updateNpieces);	
</script>
</body>


	</html>





